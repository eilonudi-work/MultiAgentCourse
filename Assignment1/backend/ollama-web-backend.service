[Unit]
Description=Ollama Web GUI Backend API
After=network.target
Documentation=https://github.com/yourusername/ollama-web-gui

[Service]
Type=simple
User=www-data
Group=www-data
WorkingDirectory=/opt/ollama-web-backend
Environment="PATH=/opt/ollama-web-backend/venv/bin"
EnvironmentFile=/opt/ollama-web-backend/.env

# Security hardening
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/opt/ollama-web-backend/logs /opt/ollama-web-backend/backups /opt/ollama-web-backend/data

# Resource limits
LimitNOFILE=65536
LimitNPROC=4096

# Restart policy
Restart=always
RestartSec=10
StartLimitInterval=5min
StartLimitBurst=3

# Start command
ExecStart=/opt/ollama-web-backend/venv/bin/uvicorn app.main:app \
    --host 0.0.0.0 \
    --port 8000 \
    --workers 4 \
    --log-level info

# Reload command
ExecReload=/bin/kill -HUP $MAINPID

# Stop command
KillMode=mixed
KillSignal=SIGTERM
TimeoutStopSec=30

[Install]
WantedBy=multi-user.target
